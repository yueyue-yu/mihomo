mixed-port: 7897
external-controller: 127.0.0.1:9090
# external-ui: ui  # å¦‚éœ€ç½‘é¡µé¢æ¿ï¼Œè¯·å–æ¶ˆæ³¨é‡Šå¹¶å°†UIæ–‡ä»¶æ”¾å…¥ ./ui ç›®å½•
allow-lan: true
mode: rule
log-level: info
unified-delay: true
tcp-concurrent: true
find-process-mode: strict
global-client-fingerprint: chrome

dns:
  enable: true
  listen: "127.0.0.1:5335"
  use-system-hosts: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  default-nameserver: [180.76.76.76, 182.254.118.118, 8.8.8.8, 180.184.2.2]
  nameserver:
    [
      180.76.76.76,
      119.29.29.29,
      180.184.1.1,
      223.5.5.5,
      8.8.8.8,
      "https://223.6.6.6/dns-query#h3=true",
      "https://dns.alidns.com/dns-query",
      "https://cloudflare-dns.com/dns-query",
      "https://doh.pub/dns-query",
    ]
  fallback:
    [
      "https://000000.dns.nextdns.io/dns-query#h3=true",
      "https://dns.alidns.com/dns-query",
      "https://doh.pub/dns-query",
      "https://public.dns.iij.jp/dns-query",
      "https://101.101.101.101/dns-query",
      "https://208.67.220.220/dns-query",
      "tls://8.8.4.4",
      "tls://1.0.0.1:853",
      "https://cloudflare-dns.com/dns-query",
      "https://dns.google/dns-query",
    ]
  fallback-filter:
    {
      geoip: true,
      ipcidr: [240.0.0.0/4, 0.0.0.0/32, 127.0.0.1/32],
      domain:
        [
          +.google.com,
          +.facebook.com,
          +.twitter.com,
          +.youtube.com,
          +.xn--ngstr-lra8j.com,
          +.google.cn,
          +.googleapis.cn,
          +.googleapis.com,
          +.gvt1.com,
        ],
    }
  fake-ip-filter:
    [
      "*.lan",
      "stun.*.*.*",
      "stun.*.*",
      time.windows.com,
      time.nist.gov,
      time.apple.com,
      time.asia.apple.com,
      "*.ntp.org.cn",
      "*.openwrt.pool.ntp.org",
      time1.cloud.tencent.com,
      time.ustc.edu.cn,
      pool.ntp.org,
      ntp.ubuntu.com,
      ntp.aliyun.com,
      ntp1.aliyun.com,
      ntp2.aliyun.com,
      ntp3.aliyun.com,
      ntp4.aliyun.com,
      ntp5.aliyun.com,
      ntp6.aliyun.com,
      ntp7.aliyun.com,
      time1.aliyun.com,
      time2.aliyun.com,
      time3.aliyun.com,
      time4.aliyun.com,
      time5.aliyun.com,
      time6.aliyun.com,
      time7.aliyun.com,
      "*.time.edu.cn",
      time1.apple.com,
      time2.apple.com,
      time3.apple.com,
      time4.apple.com,
      time5.apple.com,
      time6.apple.com,
      time7.apple.com,
      time1.google.com,
      time2.google.com,
      time3.google.com,
      time4.google.com,
      music.163.com,
      "*.music.163.com",
      "*.126.net",
      musicapi.taihe.com,
      music.taihe.com,
      songsearch.kugou.com,
      trackercdn.kugou.com,
      "*.kuwo.cn",
      api-jooxtt.sanook.com,
      api.joox.com,
      joox.com,
      y.qq.com,
      "*.y.qq.com",
      streamoc.music.tc.qq.com,
      mobileoc.music.tc.qq.com,
      isure.stream.qqmusic.qq.com,
      dl.stream.qqmusic.qq.com,
      aqqmusic.tc.qq.com,
      amobile.music.tc.qq.com,
      "*.xiami.com",
      "*.music.migu.cn",
      music.migu.cn,
      "*.msftconnecttest.com",
      "*.msftncsi.com",
      localhost.ptlogin2.qq.com,
      "*.*.*.srv.nintendo.net",
      "*.*.stun.playstation.net",
      "xbox.*.*.microsoft.com",
      "*.ipv6.microsoft.com",
      "*.*.xboxlive.com",
      speedtest.cros.wr.pvp.net,
    ]

sniffer:
  enable: true
  parse-pure-ip: true
  sniff:
    TLS: { ports: [443, 8443] }
    HTTP: { ports: [80, 8080-8880], override-destination: true }

rule-providers:
  private:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.yaml
    path: ./ruleset/private.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http
  cn_domain:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.yaml
    path: ./ruleset/cn_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http
  telegram_domain:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.yaml
    path: ./ruleset/telegram_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http
  google_domain:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google.yaml
    path: ./ruleset/google_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http
  geolocation-!cn:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/geolocation-!cn.yaml
    path: ./ruleset/geolocation-!cn.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http
  cn_ip:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.yaml
    path: ./ruleset/cn_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml
    type: http
  telegram_ip:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.yaml
    path: ./ruleset/telegram_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml
    type: http
  google_ip:
    url: https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.yaml
    path: ./ruleset/google_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml
    type: http
  bing:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Bing/Bing.yaml
    path: ./ruleset/bing.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  copilot:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Copilot/Copilot.yaml
    path: ./ruleset/copilot.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  claude:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml
    path: ./ruleset/claude.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  bard:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BardAI/BardAI.yaml
    path: ./ruleset/bard.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  openai:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml
    path: ./ruleset/openai.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  steam:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Steam/Steam.yaml
    path: ./ruleset/steam.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  youtube:
    url: https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml
    path: ./ruleset/youtube.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http

proxy-groups:
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Static.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    name: PROXY
    type: select
    proxies:
      - AUTO
      - IEPL
      - Ordinary
      - HK AUTO
      - SG AUTO
      - JP AUTO
      - US AUTO
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Urltest.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    filter: (?i)IEPL
    name: IEPL
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Urltest.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®|IEPL
    name: Ordinary
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Urltest.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    name: AUTO
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/OpenAI.png
    name: AIGC
    type: select
    proxies:
      - SG AUTO
      - JP AUTO
      - US AUTO
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Telegram.png
    name: Telegram
    type: select
    proxies:
      - IEPL
      - Ordinary
      - HK AUTO
      - SG AUTO
      - JP AUTO
      - US AUTO
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/YouTube.png
    name: YouTube
    type: select
    proxies:
      - IEPL
      - Ordinary
      - HK AUTO
      - SG AUTO
      - JP AUTO
      - US AUTO
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Google.png
    name: Google
    type: select
    proxies:
      - IEPL
      - Ordinary
      - HK AUTO
      - SG AUTO
      - JP AUTO
      - US AUTO
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Steam.png
    name: Steam
    type: select
    proxies:
      - DIRECT
      - IEPL
      - Ordinary
      - HK AUTO
      - SG AUTO
      - JP AUTO
      - US AUTO
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/HK.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    filter: (?i)é¦™æ¸¯|Hong Kong|HK|ğŸ‡­ğŸ‡°
    name: HK AUTO
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/SG.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    filter: (?i)æ–°åŠ å¡|Singapore|ğŸ‡¸ğŸ‡¬
    name: SG AUTO
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/JP.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    filter: (?i)æ—¥æœ¬|Japan|ğŸ‡¯ğŸ‡µ
    name: JP AUTO
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/US.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    filter: (?i)ç¾å›½|USA|ğŸ‡ºğŸ‡¸
    name: US AUTO
    type: url-test
    interval: 300
    tolerance: 50
  - icon: https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Global.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®
    proxies:
      - PROXY
      - AUTO
      - IEPL
      - Ordinary
      - AIGC
      - Telegram
      - YouTube
      - Google
      - Steam
      - HK AUTO
      - SG AUTO
      - JP AUTO
      - US AUTO
    name: GLOBAL
    type: select

rules:
  - "RULE-SET,private,DIRECT"
  - "RULE-SET,bing,AIGC"
  - "RULE-SET,copilot,AIGC"
  - "RULE-SET,bard,AIGC"
  - "RULE-SET,openai,AIGC"
  - "RULE-SET,claude,AIGC"
  - "RULE-SET,steam,Steam"
  - "RULE-SET,telegram_domain,Telegram"
  - "RULE-SET,telegram_ip,Telegram"
  - "RULE-SET,youtube,YouTube"
  - "RULE-SET,google_domain,Google"
  - "RULE-SET,google_ip,Google"
  - "RULE-SET,geolocation-!cn,PROXY"
  - "RULE-SET,cn_domain,DIRECT"
  - "RULE-SET,cn_ip,DIRECT"
  - "MATCH,PROXY"
